local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer

-- 1. Находим оригинальный бандаж
local originalBandage = workspace:WaitForChild("RuntimeItems"):WaitForChild("Bandage")

-- 2. Создаем точную копию
local bandageCopy = originalBandage:Clone()
bandageCopy.Name = "Bandage_Clone_"..os.time()

-- 3. Меняем только то, что нужно для уникальности
bandageCopy:SetAttribute("UniqueID", math.random(100000,999999))
bandageCopy.Handle:SetAttribute("OriginalID", nil)

-- 4. Находим ВСЕ связанные скрипты
local function copyScripts(original, copy)
    for _, descendant in ipairs(original:GetDescendants()) do
        if descendant:IsA("Script") or descendant:IsA("LocalScript") then
            local scriptCopy = descendant:Clone()
            -- Заменяем ссылки на оригинал в коде скриптов
            local source = scriptCopy.Source
            source = source:gsub(original.Name, copy.Name)
            scriptCopy.Source = source
            scriptCopy.Parent = copy
            scriptCopy.Disabled = false
        end
    end
end

-- 5. Копируем оригинальные кнопки интерфейса
local function cloneUI()
    local originalUI = player.PlayerGui:FindFirstChild("BandageUI", true)
    if originalUI then
        local uiCopy = originalUI:Clone()
        uiCopy.Name = "BandageUI_Clone"
        
        -- Обновляем ссылки в клонированном интерфейсе
        for _, element in ipairs(uiCopy:GetDescendants()) do
            if element:IsA("TextButton") then
                local clickDetector = element:FindFirstChildOfClass("ClickDetector")
                if clickDetector then
                    clickDetector:Destroy() -- Удаляем старый обработчик
                    
                    -- Подключаем к нашему клону
                    element.MouseButton1Click:Connect(function()
                        ReplicatedStorage:FindFirstChild("RequestStartDrag"):FireServer(true, bandageCopy.Name)
                    end)
                end
            end
        end
        
        uiCopy.Parent = player.PlayerGui
    end
end

-- 6. Подключаем все механизмы
copyScripts(originalBandage, bandageCopy)
cloneUI()

-- 7. Фикс для сетевой синхронизации
bandageCopy.Handle:SetNetworkOwner(nil)
bandageCopy.Parent = workspace

print("✅ Точная копия бандажа создана!")
print("Его имя: "..bandageCopy.Name)
setclipboard(bandageCopy.Name)
