-- Получаем доступ к нужным объектам
local workspace = game:GetService("Workspace")
local player = game.Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local hrp = char:WaitForChild("HumanoidRootPart")

-- Функция для клонирования кубов и создания вертолёта
local function spawnHelicopter()
    local heli = Instance.new("Model", workspace)
    heli.Name = "Helicopter"

    -- Создание корпуса вертолёта
    local bodyPart = nil
    for _, part in pairs(workspace:GetChildren()) do
        if part:IsA("Part") and part.Size == Vector3.new(4, 1, 8) then -- Ищем подходящий куб
            bodyPart = part:Clone()
            bodyPart.Position = hrp.Position + Vector3.new(0, 5, 0) -- Размещение над игроком
            bodyPart.Anchored = false
            bodyPart.BrickColor = BrickColor.new("Bright blue")
            bodyPart.Parent = heli
            break
        end
    end

    if not bodyPart then
        print("Не удалось найти нужный куб для корпуса!")
        return
    end

    -- Создание хвоста
    local tailPart = nil
    for _, part in pairs(workspace:GetChildren()) do
        if part:IsA("Part") and part.Size == Vector3.new(2, 1, 6) then -- Ищем подходящий куб для хвоста
            tailPart = part:Clone()
            tailPart.Position = bodyPart.Position + Vector3.new(0, 0, -7)
            tailPart.Anchored = false
            tailPart.BrickColor = BrickColor.new("Dark stone grey")
            tailPart.Parent = heli
            break
        end
    end

    -- Пропеллер
    local rotorPart = nil
    for _, part in pairs(workspace:GetChildren()) do
        if part:IsA("Part") and part.Size == Vector3.new(1, 0.2, 10) then -- Ищем подходящий куб для пропеллера
            rotorPart = part:Clone()
            rotorPart.Position = bodyPart.Position + Vector3.new(0, 2, 0) -- Размещение на корпусе
            rotorPart.Anchored = false
            rotorPart.BrickColor = BrickColor.new("Black")
            rotorPart.Parent = heli
            break
        end
    end

    -- Соединение всех частей (WeldConstraint)
    local weld1 = Instance.new("WeldConstraint", bodyPart)
    weld1.Part0 = bodyPart
    weld1.Part1 = tailPart

    local weld2 = Instance.new("WeldConstraint", bodyPart)
    weld2.Part0 = bodyPart
    weld2.Part1 = rotorPart

    -- Установка PrimaryPart для модели
    heli.PrimaryPart = bodyPart

    -- Размещение вертолёта
    heli:SetPrimaryPartCFrame(CFrame.new(hrp.Position + Vector3.new(0, 5, 0)))

    -- Пропеллер будет вращаться
    local RunService = game:GetService("RunService")
    RunService.RenderStepped:Connect(function()
        if rotorPart and rotorPart.Parent then
            rotorPart.CFrame = rotorPart.CFrame * CFrame.Angles(0, math.rad(20), 0)
        end
    end)

    -- Создание сиденья (VehicleSeat) для управления
    local seat = Instance.new("VehicleSeat", heli)
    seat.Name = "DriverSeat"
    seat.Size = Vector3.new(2, 1, 2)
    seat.Position = bodyPart.Position + Vector3.new(0, 1, 0)
    seat.Anchored = false
    seat.MaxSpeed = 200
    seat.Torque = 10000
    seat.Parent = heli

    -- Привязка сиденья к корпусу (Weld)
    local seatWeld = Instance.new("WeldConstraint", seat)
    seatWeld.Part0 = seat
    seatWeld.Part1 = bodyPart
end

-- Запуск функции спавна вертолёта
spawnHelicopter()
